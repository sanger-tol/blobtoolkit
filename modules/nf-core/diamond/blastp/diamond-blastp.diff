Changes in component 'nf-core/diamond/blastp'
'modules/nf-core/diamond/blastp/meta.yml' is unchanged
'modules/nf-core/diamond/blastp/environment.yml' is unchanged
Changes in 'diamond/blastp/main.nf':
--- modules/nf-core/diamond/blastp/main.nf
+++ modules/nf-core/diamond/blastp/main.nf
@@ -12,6 +12,7 @@
     tuple val(meta2), path(db)
     val out_ext
     val blast_columns
+    val taxid
 
     output:
     tuple val(meta), path('*.blast'), optional: true, emit: blast
@@ -32,6 +33,7 @@
     def is_compressed = fasta.getExtension() == "gz" ? true : false
     def fasta_name = is_compressed ? fasta.getBaseName() : fasta
     def columns = blast_columns ? "${blast_columns}" : ''
+    def exclude_taxon = taxid ? "--taxon-exclude ${taxid}" : ''
     switch ( out_ext ) {
         case "blast": outfmt = 0; break
         case "xml": outfmt = 5; break
@@ -51,6 +53,8 @@
         gzip -c -d ${fasta} > ${fasta_name}
     fi
 
+    mkdir ./tmpdir/
+
     DB=`find -L ./ -name "*.dmnd" | sed 's/\\.dmnd\$//'`
 
     diamond \\
@@ -59,7 +63,9 @@
         --db \$DB \\
         --query ${fasta_name} \\
         --outfmt ${outfmt} ${columns} \\
+        ${exclude_taxon} \\
         ${args} \\
+        --tmpdir ./tmpdir/ \\
         --out ${prefix}.${out_ext}
 
     cat <<-END_VERSIONS > versions.yml

'modules/nf-core/diamond/blastp/tests/main.nf.test' is unchanged
'modules/nf-core/diamond/blastp/tests/main.nf.test.snap' is unchanged
'modules/nf-core/diamond/blastp/tests/tags.yml' is unchanged
************************************************************
